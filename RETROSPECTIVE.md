Ретроспектива до лабораторної роботи: OOP Chess Project
1. Постановка задачі та вибір інструментів

Які задачі планували вирішувати? Основною метою було створення повноцінної настільної гри "Шахи" з графічним інтерфейсом. Ключові функціональні вимоги включали:

    Рендеринг шахівниці та фігур (SVG).

    Реалізацію правил пересування фігур та перевірку на шах/мат.

    Створення графічного меню для налаштування гри.

    Інтеграцію зовнішнього шахового рушія (Stockfish) для гри проти комп'ютера (PvE) через протокол UCI.

Чому було обрано саме ці бібліотеки?

    C++23: Для використання сучасних можливостей мови та високої продуктивності.

    SDL3: Це новітня версія популярної бібліотеки для роботи з графікою та вводом. Вона була обрана через кращу підтримку High-DPI дисплеїв, сучасний API та апаратне прискорення 2D-графіки, що критично для плавності гри.

    Dear ImGui: Стандарт де-факто для створення інтерфейсів у ігровій розробці. Вона дозволяє дуже швидко створювати меню та налагоджувальні панелі без написання складного boilerplate-коду.

    Stockfish: Один з найсильніших шахових рушіїв у світі з відкритим кодом. Використання готового рушія дозволило зосередитися на логіці програми та GUI, а не на написанні власного AI.

2. Налаштування та початок роботи

Налаштування оточення: Використання системи збірки Meson значно спростило процес підключення залежностей. Замість ручного пошуку бібліотек, більшість з них (SDL3, ImGui) підтягувалися як subprojects або системні залежності. Однак, оскільки SDL3 все ще перебуває в активній розробці (Preview), виникали нюанси з документацією та API, які могли змінюватися. Встановлення Stockfish на Linux (sudo apt install stockfish) було тривіальним.

Документація:

    Документація SDL3 є менш повною, ніж у SDL2, але вікі-сторінки та хедер-файли досить зрозумілі.

    ImGui має чудовий приклад imgui_demo.cpp, який є кращим джерелом знань, ніж будь-яка текстова документація.

    Протокол UCI (для Stockfish) добре документований у текстовому вигляді, хоча реалізація взаємодії через Linux pipes (pipe/fork/dup2) вимагала розуміння системного програмування.

3. Процес розробки та використання бібліотек

Зручність використання:

    SDL3: Надає низькорівневий контроль. Це вимагає написання більшої кількості коду (ініціалізація вікна, рендерера, цикл подій), але дає повне розуміння того, як працює додаток.

    ImGui: Надзвичайно зручна. Парадигма "Immediate Mode" дозволила створити меню, слайдери складності та кнопки управління буквально за декілька рядків коду всередині головного циклу.

Проблеми та їх вирішення: В ході роботи виникло кілька суттєвих технічних проблем:

    Якість SVG зображень:

        Проблема: При завантаженні SVG через IMG_Load, фігури виглядали "піксельними" та розмитими при масштабуванні.

        Рішення: Використано функцію IMG_LoadSizedSVG_IO для растеризації векторної графіки одразу у високій роздільній здатності (256x256), а також увімкнено лінійну фільтрацію (SDL_SetTextureScaleMode(..., SDL_SCALEMODE_LINEAR)).

    Зависання Stockfish:

        Проблема: Гра "завмирала" після певної кількості ходів. Це ставалося через те, що вивід рушія розбивався на частини (фрагментація пайпу), і програма не бачила ключове слово bestmove.

        Рішення: Реалізовано буфер (accumulator) у класі Stockfish, який накопичує вивід з read() до тих пір, поки не буде знайдено повну команду.

    Помилки лінковки (Linker Errors):

        Проблема: Виникали помилки multiple definition та undefined reference.

        Рішення: Чітке розділення оголошень у .hpp та реалізацій у .cpp. Виправлено помилкове копіювання коду з app.cpp у pieces.cpp.

    Логіка гри:

        Проблема: Можливість зробити нелегальний хід під час шаху, що ламало логіку Stockfish.

        Рішення: Додано функцію isMoveSafe, яка симулює хід на дошці та перевіряє, чи не залишається король під атакою, перш ніж дозволити хід.

4. Оцінка бібліотек

Позитивні аспекти:

    SDL3 + SDL3_image: Чудово справляються з 2D-рендерінгом та SVG. API стало більш логічним порівняно з SDL2.

    ImGui: Дозволяє дуже легко масштабувати інтерфейс (функції SetWindowFontScale, ScaleAllSizes), що зробило гру читабельною на великих екранах.

Негативні аспекти:

    Робота з пайпами (pipes) у C++ на Linux є досить низькорівневою та схильною до помилок (блокування читання, управління буфером).

    SDL3, будучи новою бібліотекою, іноді конфліктує з Wayland на Ubuntu, що вимагало примусового використання X11 (SDL_VIDEODRIVER=x11).

5. Висновки на майбутнє

Якби цю задачу довелося вирішувати знову, я б:

    Архітектура: Відокремив би логіку гри (Model) від рендерінгу (View) ще суворіше. Зараз App клас робить забагато роботи.

    Багатопотоковість: Взаємодію зі Stockfish варто було б винести в окремий потік (std::thread), щоб важкі обчислення рушія не блокували рендерінг UI (хоча ми частково вирішили це через неблокуючий read).

    Бібліотеки: Розглянув би використання бібліотеки-обгортки для UCI протоколу, щоб не писати парсинг команд вручну.

6. Використані ресурси

    SDL3 Wiki (https://wiki.libsdl.org/SDL3/FrontPage) – основне джерело документації по API (створення вікна, рендерінг). Дуже корисно.

    Dear ImGui GitHub (https://github.com/ocornut/imgui) – приклади коду та issues. Незамінно для UI.

    Stockfish UCI Protocol – опис команд position, go, uci. Корисно для розуміння комунікації.

    CppReference (https://en.cppreference.com/) – довідка по std::vector, std::unique_ptr, std::array.

    StackOverflow – вирішення проблем з пайпами в Linux та помилками лінковки.